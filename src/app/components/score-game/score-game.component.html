<div class="score-game-container" [class.has-edit-mode-bar]="isEditMode">
  <!-- Edit Mode Top Bar -->
  <div class="edit-mode-bar" *ngIf="isEditMode">
    <button class="edit-mode-close-btn" (click)="saveEditMode()" title="Sair do modo de correção">
      <i class="fas fa-chevron-left"></i>
    </button>
    <span class="edit-mode-text">MODO DE CORREÇÃO</span>
  </div>

  <!-- Main Game Section -->
  <div class="main-game-section" [class.has-edit-mode-bar]="isEditMode">
    <!-- Timer Display with Live Indicator or Start Button -->
    <div class="timer-section" *ngIf="!isEditMode">
      <!-- When match is started: show buttons and timer -->
      <div *ngIf="isMatchStarted" class="timer-with-buttons">
        <!-- Corrigir button (right side) -->
        <button 
          *ngIf="!isMatchFinished" 
          class="button-yellow button-small" 
          (click)="isEditMode ? saveEditMode() : toggleEditMode()">
          <!--i class="fas" [class.fa-edit]="!isEditMode" [class.fa-save]="isEditMode"></i--> 
          {{ isEditMode ? 'GUARDAR' : 'CORRIGIR' }}
        </button>
        
        
        
        <!-- Timer display -->
        <div class="timer-display">
          {{ formatTime(secondsElapsed) }}
        </div>
        
        <!-- Terminar button (left side) -->
        <button 
          *ngIf="!isMatchFinished" 
          class="button-red button-small" 
          (click)="finishMatch()">
          <!--i class="fas fa-stop"></i--> TERMINAR
        </button>
        
      </div>
      
      <!-- When match hasn't started: show centered start button -->
      <div *ngIf="!isMatchStarted && !isMatchFinished" class="timer-start-section">
        <div class="start-buttons-container">
          <button 
            class="button-green" 
            (click)="startMatch()">
            <!--i class="fas fa-play"></i--> COMEÇAR JOGO
          </button>
          <button 
            class="button-yellow" 
            (click)="openEditTeamsModal()">
            <!--i class="fas fa-edit"></i--> EDITAR EQUIPAS
          </button>
        </div>
      </div>
    </div>

    <!-- Final Result Display (under timer) -->
    <div *ngIf="showFinalResult" class="final-result">
      <div class="ft-text">FINAL DO JOGO</div>
    </div>

    <!-- Teams and Score Row -->
    <div class="row align-items-center justify-content-center">
      <!-- Team A -->
      <div class="col-3 text-center">
        <div class="team-content" 
             *ngIf="!showControls" 
             (click)="editTeam('A')" 
             title="Click to edit team">
          <div class="team-icon">
            <svg
              class="team-shirt-icon"
              viewBox="0 0 1024 1024"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <!-- Main body -->
              <path
                transform="translate(430,121)"
                [attr.fill]="teamAColor"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 4 2 14 11 17 12 16 9 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-4-8-5 12-7 30-4 25-3 33v72l3 51 6 88 5 57 2 42v31l-8 6-16 7-13 4-16 4-33 4-5 1-25 1-46 1-133-1-22-1-32-4-23-5-18-6-14-7-4-4-1-6v-16l1-27 5-67 2-31 2-22 3-52 3-41 1-24v-48l-2-29-5-35-6-28-4-13-2-1-11 25-5 12-2 4h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8 14-10 14-11z"
              />
              <!-- Shadows / panels -->
              <path
                transform="translate(403,143)"
                [attr.fill]="getDarkerColor(teamAColor)"
                d="m0 0h2l3 12v8l-13 6-16 7-15 7-23 12-8 6-8 8-6 9-5 11-8 25-5 28-2 19-1 60 5 44 3 26-7 16-6 13-5 13-1 2h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8z"
              />
              <path
                transform="translate(620,144)"
                [attr.fill]="getDarkerColor(teamAColor)"
                d="m0 0 10 3 14 8 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-2-5v-11l4-32 2-20v-74l-5-38-8-27-8-19-9-11-11-9-12-6-19-10-25-11-12-4-1-4z"
              />
              <!-- Collar / upper area (fixed colors) -->
              <path
                transform="translate(430,121)"
                fill="#909190"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-3 12-9 17-9 10-9 7-14 7-11 3-12 2h-41l-14-3-13-5-11-7-10-10-8-13-5-12-2-6v-20l2-6v-7z"
              />
              <path
                transform="translate(430,121)"
                fill="#ABABAB"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-2 6-10 1-20 4-31 3h-45l-22-2-26-4-12-3-1 3-2-6v-20l2-6v-7z"
              />
            </svg>
          </div>
          <div class="team-name">
            {{ teamAName }}
          </div>
        </div>
        <div class="team-content" *ngIf="showControls">
          <div class="team-icon">
            <svg
              class="team-shirt-icon"
              viewBox="0 0 1024 1024"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <!-- Main body -->
              <path
                transform="translate(430,121)"
                [attr.fill]="teamAColor"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 4 2 14 11 17 12 16 9 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-4-8-5 12-7 30-4 25-3 33v72l3 51 6 88 5 57 2 42v31l-8 6-16 7-13 4-16 4-33 4-5 1-25 1-46 1-133-1-22-1-32-4-23-5-18-6-14-7-4-4-1-6v-16l1-27 5-67 2-31 2-22 3-52 3-41 1-24v-48l-2-29-5-35-6-28-4-13-2-1-11 25-5 12-2 4h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8 14-10 14-11z"
              />
              <!-- Shadows / panels -->
              <path
                transform="translate(403,143)"
                [attr.fill]="getDarkerColor(teamAColor)"
                d="m0 0h2l3 12v8l-13 6-16 7-15 7-23 12-8 6-8 8-6 9-5 11-8 25-5 28-2 19-1 60 5 44 3 26-7 16-6 13-5 13-1 2h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8z"
              />
              <path
                transform="translate(620,144)"
                [attr.fill]="getDarkerColor(teamAColor)"
                d="m0 0 10 3 14 8 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-2-5v-11l4-32 2-20v-74l-5-38-8-27-8-19-9-11-11-9-12-6-19-10-25-11-12-4-1-4z"
              />
              <!-- Collar / upper area (fixed colors) -->
              <path
                transform="translate(430,121)"
                fill="#909190"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-3 12-9 17-9 10-9 7-14 7-11 3-12 2h-41l-14-3-13-5-11-7-10-10-8-13-5-12-2-6v-20l2-6v-7z"
              />
              <path
                transform="translate(430,121)"
                fill="#ABABAB"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-2 6-10 1-20 4-31 3h-45l-22-2-26-4-12-3-1 3-2-6v-20l2-6v-7z"
              />
            </svg>
          </div>
          <div class="team-name">
            {{ teamAName }}
          </div>
        </div>
      </div>

      <!-- Score Display -->
      <div class="col-5 text-center px-0">
        <div class="score">
          {{ teamAScore }} - {{ teamBScore }}
        </div>
      </div>

      <!-- Team B -->
      <div class="col-3 text-center">
        <div class="team-content" 
             *ngIf="!showControls" 
             (click)="editTeam('B')" 
             title="Click to edit team">
          <div class="team-icon">
            <svg
              class="team-shirt-icon"
              viewBox="0 0 1024 1024"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <!-- Main body -->
              <path
                transform="translate(430,121)"
                [attr.fill]="teamBColor"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 4 2 14 11 17 12 16 9 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-4-8-5 12-7 30-4 25-3 33v72l3 51 6 88 5 57 2 42v31l-8 6-16 7-13 4-16 4-33 4-5 1-25 1-46 1-133-1-22-1-32-4-23-5-18-6-14-7-4-4-1-6v-16l1-27 5-67 2-31 2-22 3-52 3-41 1-24v-48l-2-29-5-35-6-28-4-13-2-1-11 25-5 12-2 4h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8 14-10 14-11z"
              />
              <!-- Shadows / panels -->
              <path
                transform="translate(403,143)"
                [attr.fill]="getDarkerColor(teamBColor)"
                d="m0 0h2l3 12v8l-13 6-16 7-15 7-23 12-8 6-8 8-6 9-5 11-8 25-5 28-2 19-1 60 5 44 3 26-7 16-6 13-5 13-1 2h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8z"
              />
              <path
                transform="translate(620,144)"
                [attr.fill]="getDarkerColor(teamBColor)"
                d="m0 0 10 3 14 8 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-2-5v-11l4-32 2-20v-74l-5-38-8-27-8-19-9-11-11-9-12-6-19-10-25-11-12-4-1-4z"
              />
              <!-- Collar / upper area (fixed colors) -->
              <path
                transform="translate(430,121)"
                fill="#909190"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-3 12-9 17-9 10-9 7-14 7-11 3-12 2h-41l-14-3-13-5-11-7-10-10-8-13-5-12-2-6v-20l2-6v-7z"
              />
              <path
                transform="translate(430,121)"
                fill="#ABABAB"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-2 6-10 1-20 4-31 3h-45l-22-2-26-4-12-3-1 3-2-6v-20l2-6v-7z"
              />
            </svg>
          </div>
          <div class="team-name">
            {{ teamBName }}
          </div>
        </div>
        <div class="team-content" *ngIf="showControls">
          <div class="team-icon">
            <svg
              class="team-shirt-icon"
              viewBox="0 0 1024 1024"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <!-- Main body -->
              <path
                transform="translate(430,121)"
                [attr.fill]="teamBColor"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 4 2 14 11 17 12 16 9 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-4-8-5 12-7 30-4 25-3 33v72l3 51 6 88 5 57 2 42v31l-8 6-16 7-13 4-16 4-33 4-5 1-25 1-46 1-133-1-22-1-32-4-23-5-18-6-14-7-4-4-1-6v-16l1-27 5-67 2-31 2-22 3-52 3-41 1-24v-48l-2-29-5-35-6-28-4-13-2-1-11 25-5 12-2 4h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8 14-10 14-11z"
              />
              <!-- Shadows / panels -->
              <path
                transform="translate(403,143)"
                [attr.fill]="getDarkerColor(teamBColor)"
                d="m0 0h2l3 12v8l-13 6-16 7-15 7-23 12-8 6-8 8-6 9-5 11-8 25-5 28-2 19-1 60 5 44 3 26-7 16-6 13-5 13-1 2h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8z"
              />
              <path
                transform="translate(620,144)"
                [attr.fill]="getDarkerColor(teamBColor)"
                d="m0 0 10 3 14 8 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-2-5v-11l4-32 2-20v-74l-5-38-8-27-8-19-9-11-11-9-12-6-19-10-25-11-12-4-1-4z"
              />
              <!-- Collar / upper area (fixed colors) -->
              <path
                transform="translate(430,121)"
                fill="#909190"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-3 12-9 17-9 10-9 7-14 7-11 3-12 2h-41l-14-3-13-5-11-7-10-10-8-13-5-12-2-6v-20l2-6v-7z"
              />
              <path
                transform="translate(430,121)"
                fill="#ABABAB"
                d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-2 6-10 1-20 4-31 3h-45l-22-2-26-4-12-3-1 3-2-6v-20l2-6v-7z"
              />
            </svg>
          </div>
          <div class="team-name">
            {{ teamBName }}
          </div>
        </div>
      </div>
    </div>

     <!-- Access Video Button (only shown when match is finished) -->
    <div class="row align-items-center justify-content-center mb-4">
      <div class="col-12 text-center">
        <div *ngIf="isMatchFinished && isRecordingMode" class="access-video-section">
          <button class="button-green" (click)="onAccessVideo()">
            <!--i class="fas fa-video"></i--> Aceder aos vídeos
          </button>
        </div>
      </div>
   </div>

    <!-- Action Buttons Row -->
    <div class="row align-items-center justify-content-center mb" *ngIf="showControls">
      <!-- Team A Goal Button -->
      <div class="col-3 text-center px-0">
        <button class="btn btn-goal team-a-goal" (click)="addTeamGoal('A')" [disabled]="isEditMode">
          <i class="fas fa-futbol"></i>
          <span class="goal-text">GOLO</span>
        </button>
      </div>

      <!-- Highlight Button -->
      <div class="col-5 text-center px-0">
        <button class="btn btn-highlight" (click)="addHighlight()" [disabled]="isEditMode">
          <i class="fas fa-hands-clapping"></i>
          <span class="highlight-text">HIGHLIGHT</span>
        </button>
      </div>

      <!-- Team B Goal Button -->
      <div class="col-3 text-center px-0">
        <button class="btn btn-goal team-b-goal" (click)="addTeamGoal('B')" [disabled]="isEditMode">
          <i class="fas fa-futbol"></i>
          <span class="goal-text">GOLO</span>
        </button>
      </div>
    </div>

    <!-- Event Logs -->
    <app-event-log class="mt-3"
      [teamAEvents]="teamAEvents"
      [teamBEvents]="teamBEvents"
      [highlightEvents]="highlightEvents"
      [showControls]="showControls"
      [teamAScore]="teamAScore"
      [teamBScore]="teamBScore"
      [teamAColor]="teamAColor"
      [teamBColor]="teamBColor"
      [isEditMode]="isEditMode"
      [isMatchFinished]="isMatchFinished"
      (editEvent)="openEventEditModal($event)"
    ></app-event-log>

  </div>

  <!-- Edit Both Teams Modal -->
  <div class="teams-edit-modal-backdrop" *ngIf="showEditTeamsModal" (click)="closeEditTeamsModal()"></div>
  <div class="teams-edit-modal" *ngIf="showEditTeamsModal" (click)="$event.stopPropagation()">
    <div class="teams-edit-content">
      <div class="teams-edit-header">
        <h4>EDITAR EQUIPAS</h4>
        <button class="close-modal" (click)="closeEditTeamsModal()"><i class="fas fa-times"></i></button>
      </div>
      
      <div class="teams-edit-body">
        <!-- Team A Section -->
        <div class="team-section">
          <h5>Equipa da casa</h5>
          <div class="input-group">
            <input 
              type="text" 
              #teamANameInput
              [value]="teamAName"
              (input)="teamAName = teamANameInput.value"
              placeholder="Nome da equipa A"
              class="name-input"
              maxlength="20"
            >
          </div>
          <div class="input-group">
            <div class="color-picker">
              <button 
                *ngFor="let color of teamColorOptions" 
                type="button"
                class="color-option"
                [ngStyle]="{'background-color': color}"
                [class.selected]="teamAColor === color"
                (click)="teamAColor = color"
                [attr.aria-label]="color"
              >
                <i class="fas fa-check" *ngIf="teamAColor === color"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Team B Section -->
        <div class="team-section">
          <h5>Equipa visitante</h5>
          <div class="input-group">
            <input 
              type="text" 
              #teamBNameInput
              [value]="teamBName"
              (input)="teamBName = teamBNameInput.value"
              placeholder="Nome da equipa B"
              class="name-input"
              maxlength="20"
            >
          </div>
          <div class="input-group">
            <div class="color-picker">
              <button 
                *ngFor="let color of teamColorOptions" 
                type="button"
                class="color-option"
                [ngStyle]="{'background-color': color}"
                [class.selected]="teamBColor === color"
                (click)="teamBColor = color"
                [attr.aria-label]="color"
              >
                <i class="fas fa-check" *ngIf="teamBColor === color"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="teams-edit-footer">
        <button
          class="button-green teams-edit-save-button"
          (click)="onSaveBothTeams({ name: teamAName, color: teamAColor }, { name: teamBName, color: teamBColor })"
          [disabled]="!teamAName.trim() || !teamBName.trim()">
          Guardar
        </button>
      </div>
    </div>
  </div>

  <!-- Start Match Confirmation Modal -->
  <app-confirmation-modal
    [isVisible]="showStartConfirmModal"
    title="Start New Match"
    message="Starting a new match will clear the current events. Proceed?"
    confirmText="Start Match"
    cancelText="Cancel"
    (confirm)="onConfirmStartMatch()"
    (cancel)="onCancelStartMatch()"
  ></app-confirmation-modal>

  <!-- Attacking Team Selection Modal (recording mode) -->
  <app-confirmation-modal
    [isVisible]="showAttackingTeamModal"
    title="CONFIGURAÇÃO DE GRAVAÇÃO"
    message="Por trás de uma das balizas há um alvo. Que equipa vai estar a atacar para essa baliza?"
    [confirmText]="teamBName"
    [cancelText]="teamAName"
    [confirmButtonColor]="teamBColor"
    [cancelButtonColor]="teamAColor"
    [disableOverlayClose]="true"
    imageUrl="assets/AlvoAtrasBaliza_Imagem.png"
    (confirm)="chooseAttackingTeam('B')"
    (cancel)="chooseAttackingTeam('A')"
  ></app-confirmation-modal>

  <!-- Start Match Error Modal -->
  <app-confirmation-modal
    [isVisible]="showStartMatchErrorModal"
    title="Erro ao iniciar jogo"
    message="Não foi possível iniciar o jogo. Por favor insere novamente o código de gravação"
    confirmText="OK"
    cancelText=""
    (confirm)="onCloseStartMatchErrorModal()"
    (cancel)="onCloseStartMatchErrorModal()"
  ></app-confirmation-modal>

  <!-- Finish Match Confirmation Modal -->
  <div class="teams-edit-modal-backdrop" *ngIf="showConfirmModal" (click)="onCancelFinishMatch()"></div>
  <div class="teams-edit-modal" *ngIf="showConfirmModal" (click)="$event.stopPropagation()">
    <div class="teams-edit-content">
      <div class="teams-edit-header">
        <h4>{{ isRecordingMode ? 'Terminar o jogo e gravação' : 'Terminar o Jogo' }}</h4>
        <button class="close-modal" (click)="onCancelFinishMatch()"><i class="fas fa-times"></i></button>
      </div>
      
      <div class="teams-edit-body">
        <p style="color: white; margin: 0; font-size: 1rem; line-height: 1.5;">
          {{ isRecordingMode ? 'Tens a certeza que queres terminar o jogo e parar a gravação?' : 'Tens a certeza que queres terminar o jogo?' }}
        </p>
      </div>
      
      <div class="teams-edit-footer">
        <button class="button-red" (click)="onCancelFinishMatch()">
          Cancelar
        </button>
        <button class="button-green" (click)="onConfirmFinishMatch()">
          Terminar o Jogo
        </button>
      </div>
    </div>
  </div>

  <!-- Photo Capture Modal -->
  <div class="photo-capture-modal" *ngIf="isCapturingPhoto">
    <div class="photo-capture-content">
      <div class="photo-capture-header">
        <h3>Querem tirar a foto de final de Jogo?</h3>
      </div>
      
      <div class="photo-capture-body">
        <div class="photo-preview" *ngIf="photoUploadProgress === 0">
          <div class="camera-icon">
            <i class="fas fa-camera"></i>
          </div>
          <p>A Camera irá abrir assim que clicarem no botão de "Tirar Foto"</p>
        </div>
        
        <div class="upload-progress" *ngIf="photoUploadProgress > 0">
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="photoUploadProgress"></div>
          </div>
          <p *ngIf="photoUploadProgress < 100">Uploading photo...</p>
          <p *ngIf="photoUploadProgress === 100">Photo uploaded successfully!</p>
        </div>
      </div>
      
      <div class="photo-capture-controls">
        <button 
          class="button-red" 
          (click)="skipPhotoCapture()"
          [disabled]="photoUploadProgress > 0">
          Não tirar
        </button>
        <button 
          class="button-green" 
          (click)="retryPhotoCapture()"
          [disabled]="photoUploadProgress > 0">
          <i class="fas fa-camera"></i> Tirar Foto
        </button>
      </div>
    </div>
  </div>

  <!-- Large Photo Preview Modal -->
  <div class="photo-preview-modal" *ngIf="showPhotoPreviewModal">
    <div class="photo-preview-content">
      <button class="close-preview-btn" (click)="closePhotoPreview()">&times;</button>
      <h3>Match Photo</h3>
      <img *ngIf="lastCapturedPhotoUrl" [src]="lastCapturedPhotoUrl" alt="Match photo" class="photo-preview-image" />
    </div>
  </div>

  <!-- Event Edit Modal -->
  <div class="event-edit-modal" *ngIf="showEventEditModal">
    <div class="event-edit-content">
      <div class="event-edit-header">
        <!--<h3>Editar: {{ getCurrentEventType() | titlecase }}</h3>-->
        <button class="close-edit-btn" (click)="closeEventEditModal()">&times;</button>
      </div>
      
      <div class="event-edit-body">
        <!-- Result Preview -->
        <div class="result-preview">
          <div class="preview-label">Resultado</div>
          <div class="preview-score-display">
            <!-- Team A -->
            <div class="preview-team">
              <div class="preview-team-icon">
                <svg
                  class="team-shirt-icon"
                  viewBox="0 0 1024 1024"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <!-- Main body -->
                  <path
                    transform="translate(430,121)"
                    [attr.fill]="teamAColor"
                    d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 4 2 14 11 17 12 16 9 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-4-8-5 12-7 30-4 25-3 33v72l3 51 6 88 5 57 2 42v31l-8 6-16 7-13 4-16 4-33 4-5 1-25 1-46 1-133-1-22-1-32-4-23-5-18-6-14-7-4-4-1-6v-16l1-27 5-67 2-31 2-22 3-52 3-41 1-24v-48l-2-29-5-35-6-28-4-13-2-1-11 25-5 12-2 4h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8 14-10 14-11z"
                  />
                  <!-- Shadows / panels -->
                  <path
                    transform="translate(403,143)"
                    [attr.fill]="getDarkerColor(teamAColor)"
                    d="m0 0h2l3 12v8l-13 6-16 7-15 7-23 12-8 6-8 8-6 9-5 11-8 25-5 28-2 19-1 60 5 44 3 26-7 16-6 13-5 13-1 2h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8z"
                  />
                  <path
                    transform="translate(620,144)"
                    [attr.fill]="getDarkerColor(teamAColor)"
                    d="m0 0 10 3 14 8 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-2-5v-11l4-32 2-20v-74l-5-38-8-27-8-19-9-11-11-9-12-6-19-10-25-11-12-4-1-4z"
                  />
                  <!-- Collar / upper area (fixed colors) -->
                  <path
                    transform="translate(430,121)"
                    fill="#909190"
                    d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-3 12-9 17-9 10-9 7-14 7-11 3-12 2h-41l-14-3-13-5-11-7-10-10-8-13-5-12-2-6v-20l2-6v-7z"
                  />
                  <path
                    transform="translate(430,121)"
                    fill="#ABABAB"
                    d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-2 6-10 1-20 4-31 3h-45l-22-2-26-4-12-3-1 3-2-6v-20l2-6v-7z"
                  />
                </svg>
              </div>
              <div class="preview-team-name">{{ teamAName }}</div>
              <div class="preview-score-value" 
                   [class.blinking]="isTeamAScoreBeingEdited()">
                {{ getNewTeamAScore() }}
              </div>
            </div>
            
            <!-- Score Separator -->
            <div class="preview-score-separator">-</div>
            
            <!-- Team B -->
            <div class="preview-team">
              <div class="preview-team-icon">
                <svg
                  class="team-shirt-icon"
                  viewBox="0 0 1024 1024"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <!-- Main body -->
                  <path
                    transform="translate(430,121)"
                    [attr.fill]="teamBColor"
                    d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 4 2 14 11 17 12 16 9 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-4-8-5 12-7 30-4 25-3 33v72l3 51 6 88 5 57 2 42v31l-8 6-16 7-13 4-16 4-33 4-5 1-25 1-46 1-133-1-22-1-32-4-23-5-18-6-14-7-4-4-1-6v-16l1-27 5-67 2-31 2-22 3-52 3-41 1-24v-48l-2-29-5-35-6-28-4-13-2-1-11 25-5 12-2 4h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8 14-10 14-11z"
                  />
                  <!-- Shadows / panels -->
                  <path
                    transform="translate(403,143)"
                    [attr.fill]="getDarkerColor(teamBColor)"
                    d="m0 0h2l3 12v8l-13 6-16 7-15 7-23 12-8 6-8 8-6 9-5 11-8 25-5 28-2 19-1 60 5 44 3 26-7 16-6 13-5 13-1 2h-25l-19-3-18-6-17-8-18-12-13-11-7-7-8-10 1-7 7-21 10-28 15-40 17-43 10-24 11-25 5-9 7-9 5-6 13-10 12-7 20-9 27-9 47-12 13-5 15-8z"
                  />
                  <path
                    transform="translate(620,144)"
                    [attr.fill]="getDarkerColor(teamBColor)"
                    d="m0 0 10 3 14 8 15 5 15 4 35 9 25 9 21 10 14 10 10 9 8 11 8 16 11 24 9 22 17 43 11 29 12 33 9 24-1 7-16 16-10 9-15 10-15 8-21 8-15 3-10 1h-23l-3-5-6-16-6-13-2-5v-11l4-32 2-20v-74l-5-38-8-27-8-19-9-11-11-9-12-6-19-10-25-11-12-4-1-4z"
                  />
                  <!-- Collar / upper area (fixed colors) -->
                  <path
                    transform="translate(430,121)"
                    fill="#909190"
                    d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-3 12-9 17-9 10-9 7-14 7-11 3-12 2h-41l-14-3-13-5-11-7-10-10-8-13-5-12-2-6v-20l2-6v-7z"
                  />
                  <path
                    transform="translate(430,121)"
                    fill="#ABABAB"
                    d="m0 0 5 2 15 5 24 4 31 2h17l28-2 23-4 14-4 6-3 3 1-2 1 3 9 1 5v16l-2 6-10 1-20 4-31 3h-45l-22-2-26-4-12-3-1 3-2-6v-20l2-6v-7z"
                  />
                </svg>
              </div>
              <div class="preview-team-name">{{ teamBName }}</div>
              <div class="preview-score-value" 
                   [class.blinking]="isTeamBScoreBeingEdited()">
                {{ getNewTeamBScore() }}
              </div>
            </div>
          </div>
        </div>
        
        <!-- Event Type Selection -->
        <div class="form-group">
          <label>Tipo de Evento:</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" 
                     name="eventType" 
                     value="goal" 
                     [(ngModel)]="editingEventType"
                     [checked]="editingEventType === 'goal'">
              <span class="radio-icon"><i class="fas fa-futbol"></i></span>
              <span class="radio-label">Golo</span>
            </label>
            <label class="radio-option">
              <input type="radio" 
                     name="eventType" 
                     value="highlight" 
                     [(ngModel)]="editingEventType"
                     [checked]="editingEventType === 'highlight'">
              <span class="radio-icon"><i class="fas fa-hands-clapping"></i></span>
              <span class="radio-label">Highlight</span>
            </label>
          </div>
        </div>

        <!-- Team Selection (only for goals) -->
        <div class="form-group" *ngIf="editingEventType === 'goal'">
          <label>Equipa:</label>
          <div class="radio-group">
            <label class="radio-option" 
                   data-team="A"
                   [ngStyle]="getTeamAStyle()"
                   [style.--team-color]="teamAColor">
              <input type="radio" 
                     name="eventTeam" 
                     value="A" 
                     [(ngModel)]="editingEventTeamSelection"
                     [checked]="editingEventTeamSelection === 'A'">
              <span class="radio-label" 
                    [ngStyle]="{'color': editingEventTeamSelection === 'A' ? teamAColor : 'white'}">
                {{ teamAName }}
              </span>
            </label>
            <label class="radio-option" 
                   data-team="B"
                   [ngStyle]="getTeamBStyle()"
                   [style.--team-color]="teamBColor">
              <input type="radio" 
                     name="eventTeam" 
                     value="B" 
                     [(ngModel)]="editingEventTeamSelection"
                     [checked]="editingEventTeamSelection === 'B'">
              <span class="radio-label" 
                    [ngStyle]="{'color': editingEventTeamSelection === 'B' ? teamBColor : 'white'}">
                {{ teamBName }}
              </span>
            </label>
          </div>
        </div>
      </div>
      
      <div class="event-edit-controls">
        <button class="button-red" (click)="deleteEvent()">
          <!--i class="fas fa-trash"></i--> Eliminar
        </button>
        <button class="button-green" (click)="saveEventEdit()">
          <!--i class="fas fa-save"></i--> Guardar
        </button>
      </div>
    </div>
  </div>

  <!-- Live Indicator Dock Bar (bottom of page) -->
  <div class="live-indicator-dock" *ngIf="isRecordingMode && isMatchStarted">
    <app-live-indicator [isRecording]="isRecording"></app-live-indicator>
  </div>
</div>
