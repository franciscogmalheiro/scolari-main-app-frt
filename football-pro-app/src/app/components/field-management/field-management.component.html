<div class="field-management">
  <!-- Header -->
  <div class="management-header">
    <div class="header-content">
      <h2>Field Management</h2>
      <button class="create-btn" (click)="openCreateModal()">
        <span class="btn-icon">➕</span>
        Add New Field
      </button>
    </div>
  </div>

  <!-- Messages -->
  <div *ngIf="errorMessage" class="message error-message">
    <span class="message-icon">⚠️</span>
    {{ errorMessage }}
  </div>

  <div *ngIf="successMessage" class="message success-message">
    <span class="message-icon">✅</span>
    {{ successMessage }}
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading fields...</p>
  </div>

  <!-- Fields Table -->
  <div *ngIf="!isLoading" class="table-container">
    <table class="fields-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Sport</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let field of fields" class="field-row">
          <td class="field-name">{{ field.name }}</td>
          <td class="field-sport">{{ getSportName(field.sportId) }}</td>
          <td class="field-date">{{ field.createdAt | date:'short' }}</td>
          <td class="field-actions">
            <button class="action-btn edit-btn" (click)="openEditModal(field)" title="Edit Field">
              <span class="action-icon">✏️</span>
            </button>
            <button class="action-btn delete-btn" (click)="openDeleteModal(field)" title="Delete Field">
              <span class="action-icon">🗑️</span>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Empty State -->
    <div *ngIf="fields.length === 0" class="empty-state">
      <div class="empty-icon">🏟️</div>
      <h3>No Fields Found</h3>
      <p>Get started by adding your first field.</p>
      <button class="create-btn" (click)="openCreateModal()">
        <span class="btn-icon">➕</span>
        Add First Field
      </button>
    </div>
  </div>

  <!-- Create Field Modal -->
  <div *ngIf="showCreateModal" class="modal-overlay" (click)="closeModals()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Create New Field</h3>
        <button class="close-btn" (click)="closeModals()">✕</button>
      </div>
      
      <form [formGroup]="fieldForm" (ngSubmit)="createField()" class="modal-form">
        <div class="form-group">
          <label for="name">Field Name *</label>
          <input 
            type="text" 
            id="name"
            formControlName="name"
            placeholder="Enter field name"
            [class.error]="fieldForm.get('name')?.invalid && fieldForm.get('name')?.touched"
          >
          <div *ngIf="fieldForm.get('name')?.invalid && fieldForm.get('name')?.touched" class="error-text">
            <span *ngIf="fieldForm.get('name')?.errors?.['required']">Field name is required</span>
            <span *ngIf="fieldForm.get('name')?.errors?.['minlength']">Field name must be at least 2 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="sportId">Sport *</label>
          <select 
            id="sportId"
            formControlName="sportId"
            [class.error]="fieldForm.get('sportId')?.invalid && fieldForm.get('sportId')?.touched"
          >
            <option value="">Select a sport</option>
            <option *ngFor="let sport of sports" [value]="sport.id">{{ sport.name }}</option>
          </select>
          <div *ngIf="fieldForm.get('sportId')?.invalid && fieldForm.get('sportId')?.touched" class="error-text">
            <span *ngIf="fieldForm.get('sportId')?.errors?.['required']">Sport is required</span>
          </div>
        </div>

        <div class="modal-actions">
          <button type="button" class="cancel-btn" (click)="closeModals()">Cancel</button>
          <button type="submit" class="submit-btn" [disabled]="fieldForm.invalid || isLoading">
            <span *ngIf="isLoading" class="loading-spinner-small"></span>
            {{ isLoading ? 'Creating...' : 'Create Field' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Field Modal -->
  <div *ngIf="showEditModal" class="modal-overlay" (click)="closeModals()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Edit Field</h3>
        <button class="close-btn" (click)="closeModals()">✕</button>
      </div>
      
      <form [formGroup]="fieldForm" (ngSubmit)="updateField()" class="modal-form">
        <div class="form-group">
          <label for="edit-name">Field Name *</label>
          <input 
            type="text" 
            id="edit-name"
            formControlName="name"
            placeholder="Enter field name"
            [class.error]="fieldForm.get('name')?.invalid && fieldForm.get('name')?.touched"
          >
          <div *ngIf="fieldForm.get('name')?.invalid && fieldForm.get('name')?.touched" class="error-text">
            <span *ngIf="fieldForm.get('name')?.errors?.['required']">Field name is required</span>
            <span *ngIf="fieldForm.get('name')?.errors?.['minlength']">Field name must be at least 2 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="edit-sportId">Sport *</label>
          <select 
            id="edit-sportId"
            formControlName="sportId"
            [class.error]="fieldForm.get('sportId')?.invalid && fieldForm.get('sportId')?.touched"
          >
            <option value="">Select a sport</option>
            <option *ngFor="let sport of sports" [value]="sport.id">{{ sport.name }}</option>
          </select>
          <div *ngIf="fieldForm.get('sportId')?.invalid && fieldForm.get('sportId')?.touched" class="error-text">
            <span *ngIf="fieldForm.get('sportId')?.errors?.['required']">Sport is required</span>
          </div>
        </div>

        <div class="modal-actions">
          <button type="button" class="cancel-btn" (click)="closeModals()">Cancel</button>
          <button type="submit" class="submit-btn" [disabled]="fieldForm.invalid || isLoading">
            <span *ngIf="isLoading" class="loading-spinner-small"></span>
            {{ isLoading ? 'Updating...' : 'Update Field' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div *ngIf="showDeleteModal" class="modal-overlay" (click)="closeModals()">
    <div class="modal-content delete-modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Delete Field</h3>
        <button class="close-btn" (click)="closeModals()">✕</button>
      </div>
      
      <div class="delete-content">
        <div class="delete-icon">🗑️</div>
        <h4>Are you sure you want to delete this field?</h4>
        <p class="delete-warning">
          <strong>{{ selectedField?.name }}</strong> will be permanently deleted and cannot be recovered.
        </p>
        
        <div class="modal-actions">
          <button type="button" class="cancel-btn" (click)="closeModals()">Cancel</button>
          <button type="button" class="delete-confirm-btn" (click)="deleteField()" [disabled]="isLoading">
            <span *ngIf="isLoading" class="loading-spinner-small"></span>
            {{ isLoading ? 'Deleting...' : 'Delete Field' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div> 